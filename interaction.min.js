function addToXLSX(){if(7!=epx.getSheetNames().length)return void alert("Invalid file uploaded!");endAll();var e=hallPass.slice(0),t=visitors.slice(0),n=cVisits.slice(0),s=firstClass.slice(0),a=secondClass.slice(0),l=thirdClass.slice(0),i=fourthClass.slice(0);e.shift(),t.shift(),n.shift(),s.shift(),a.shift(),l.shift(),i.shift(),e=addDate(e),t=addDate(t),n=addDate(n),s=addDate(s),a=addDate(a),l=addDate(l),i=addDate(i),epx.selectSheet("Hall Pass"),writeData(epx,e),epx.selectSheet("Visitors"),writeData(epx,t),epx.selectSheet("Class Visitors"),writeData(epx,n),epx.selectSheet("Class 1"),writeData(epx,s),epx.selectSheet("Class 2"),writeData(epx,a),epx.selectSheet("Class 3"),writeData(epx,l),epx.selectSheet("Class 4"),writeData(epx,i),epx.saveAs("data.xlsx")}function writeData(e,t){for(i=0;i<t.length;i++)e.writeNextRow(t[i])}function monthWord(){var e=new Date,t=new Array("January","February","March","April","May","June","July","August","September","October","November","December");return t[e.getMonth()]}function loggedInOnly(e){switch(e){case"v":lIOV?(lIOV=!1,constructDisplay(visitors.slice(0),"vdisplay"),document.getElementById("liov").innerHTML="View Logged In Only"):(lIOV=!0,constructDisplay(visitors.slice(0),"vdisplay"),document.getElementById("liov").innerHTML="View All");break;case"h":lIOH?(lIOH=!1,constructDisplay(hallPass.slice(0),"hdisplay"),document.getElementById("lioh").innerHTML="View Logged In Only"):(lIOH=!0,constructDisplay(hallPass.slice(0),"hdisplay"),document.getElementById("lioh").innerHTML="View All");break;case"c":lIOC?(lIOC=!1,constructDisplay(cVisits.slice(0),"cdisplay"),document.getElementById("lioc").innerHTML="View Logged In Only"):(lIOC=!0,constructDisplay(cVisits.slice(0),"cdisplay"),document.getElementById("lioc").innerHTML="View All");break;default:alert("Error in loggedInOnly()!")}}function lIODisplay(e){for(i=0;i<e.length;i++)e[i][2].length<=5&&(e.splice(i,1),i--);return e}function addDate(e){var t=new Date;for(i=e.length-1;i>=0;i--)e[i].push(t.toLocaleDateString());return e}function exportXLSX(e){var t=new ExcelPlus;e&&endAll(),t.createFile(["Class 1","Class 2","Class 3","Class 4","Hall Pass","Visitors","Class Visitors"]),t.write({sheet:"Class 1",content:firstClass}),t.write({sheet:"Class 2",content:secondClass}),t.write({sheet:"Class 3",content:thirdClass}),t.write({sheet:"Class 4",content:fourthClass}),t.write({sheet:"Hall Pass",content:hallPass}),t.write({sheet:"Visitors",content:visitors}),t.write({sheet:"Class Visitors",content:cVisits});var n=new Date;t.saveAs(n.toLocaleString().replace("/","-")+".xlsx")}function tabSelect(e,t){var n,s=document.getElementsByClassName("tabcontent"),a=document.getElementsByClassName("tablinks");for(n=0;n<s.length;n++)s[n].style.display="none";for(n=0;n<a.length;n++)a[n].className=a[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}function endEntry(e,t,n){t[e][2]=getTime("string12"),constructDisplay(t.slice(0),n)}function removeEntry(e,t){switch(t){case"vdisplay":visitors.splice(e,1),constructDisplay(visitors.slice(0),t);break;case"cdisplay":cVisits.splice(e,1),constructDisplay(cVisits.slice(0),t);break;case"hdisplay":tgtArray=hallPass,hallPass.splice(e,1),constructDisplay(hallPass.slice(0),t)}}function endAll(){endVisitors(),endCVisits(),endHallPass()}function endVisitors(){for(i=visitors.length-1;i>0;i--)visitors[i][2].length>10&&endEntry(i,visitors,"vdisplay")}function endCVisits(){for(i=cVisits.length-1;i>0;i--)cVisits[i][2].length>10&&endEntry(i,cVisits,"cdisplay")}function endHallPass(){for(i=hallPass.length-1;i>0;i--)hallPass[i][2].length>10&&endEntry(i,hallPass,"hdisplay")}function constructDisplay(e,t){var n=e,s=document.getElementById(t),a="",l=0,i=0;switch(t){case"vdisplay":lIOV&&(n=lIODisplay(n));break;case"cdisplay":lIOC&&(n=lIODisplay(n));break;case"hdisplay":lIOH&&(n=lIODisplay(n));break;default:alert("Error in constructDisplay!")}for(n.reverse(),n.unshift(n.pop());l<=n.length-1;){for(a+="<tr>";i<=n[0].length-1;)a+=0==l?"<th>":"<td>",a+=n[l][i],a+=0==l?"</th>":"</td>",i++;i=0,null!=document.getElementById("sselector")&&l>0&&(a+='<td><button type="button" onclick="removeEntry('+(n.length-l)+", '"+t+"')\">X</button></td>"),a+="</tr>",l++}s.innerHTML=a}function submitData(e){var t,n=getTime("string12");switch(e){case"a":if(0==document.getElementById("afname").value.length)return void alert("You need to input a first name!");if(0==document.getElementById("alname").value.length)return void alert("You need to input a last name!");switch(t=document.getElementById("afname").value+" "+document.getElementById("alname").value,document.getElementById("afname").value="",document.getElementById("alname").value="",whichClass()){case 0:firstClass[firstClass.length]=new Array(t,n,!1);break;case 1:firstClass[firstClass.length]=new Array(t,n,!0);break;case 2:secondClass[secondClass.length]=new Array(t,n,!1);break;case 3:secondClass[secondClass.length]=new Array(t,n,!0);break;case 4:thirdClass[thirdClass.length]=new Array(t,n,!1);break;case 5:thirdClass[thirdClass.length]=new Array(t,n,!0);break;case 6:fourthClass[fourthClass.length]=new Array(t,n,!1);break;case 7:fourthClass[fourthClass.length]=new Array(t,n,!0);break;case 8:return void alert("The school day has ended!");default:return void alert("Error in submitData()!")}alert(t+" is now signed in!");break;case"h":var s=document.getElementById("hdestination"),a=s.value;if(0==document.getElementById("hfname").value.length)return void alert("You need to input a first name!");if(0==document.getElementById("hlname").value.length)return void alert("You need to input a last name!");if(null!=document.getElementById("hteacher")){var l=document.getElementById("hteacher").value;if(0==l.length)return void alert("You need to input the teacher you're going to!");a=s.value+": "+l}if(null!=document.getElementById("hcounselor")){var i=document.getElementById("hcounselor").value;if(0==i.length)return void alert("You need to input the counselor you're going to!");a=s.value+": "+i}t=document.getElementById("hfname").value+" "+document.getElementById("hlname").value,document.getElementById("hfname").value="",document.getElementById("hlname").value="",hallPass[hallPass.length]=new Array(t,n,'<button type="button" onclick="endEntry('+hallPass.length+", hallPass, 'hdisplay')\">In</button>",a),s.value="Bathroom",hallPassTeachers(),constructDisplay(hallPass.slice(0),"hdisplay");break;case"v":if(0==document.getElementById("vfname").value.length)return void alert("You need to input a first name!");if(0==document.getElementById("vlname").value.length)return void alert("You need to input a last name!");t=document.getElementById("vfname").value+" "+document.getElementById("vlname").value,document.getElementById("vfname").value="",document.getElementById("vlname").value="",visitors[visitors.length]=new Array(t,n,'<button type="button" onclick="endEntry('+visitors.length+", visitors, 'vdisplay')\">Out</button>",document.getElementById("vreason").value,document.getElementById("vteacher").value),document.getElementById("vreason").value="Work independently on a class assignment",document.getElementById("vteacher").value="C. Baker",constructDisplay(visitors.slice(0),"vdisplay");break;case"c":if(0==document.getElementById("cfname").value.length)return void alert("You need to input a first name!");if(0==document.getElementById("clname").value.length)return void alert("You need to input a last name!");if(0==document.getElementById("creason").value.length)return void alert("You need to input a reason!");if(0==document.getElementById("classsize").value.length)return void alert("You need to input the number of students!");t=document.getElementById("cfname").value+" "+document.getElementById("clname").value,document.getElementById("cfname").value="",document.getElementById("clname").value="",cVisits[cVisits.length]=new Array(t,n,'<button type="button" onclick="endEntry('+cVisits.length+", cVisits, 'cdisplay')\">Out</button>",document.getElementById("creason").value,document.getElementById("classsize").value),constructDisplay(cVisits.slice(0),"cdisplay"),document.getElementById("creason").value="",document.getElementById("classsize").value="";break;default:alert("Error in submitData()!")}}function getTime(e){var t=new Date,n=t.getHours(),s=t.getMinutes();switch(e){case"array":return[n,s];case"string12":return n>12&&(n-=12),10>s?n+":0"+s:n+":"+s;case"string24":return 10>s?n+":0"+s:n+":"+s;case"minct":return 60*n+s;default:alert("Invalid getTime() argument!")}}function passWord(e){passWordCheck(document.getElementById(e).value)?(document.getElementById("l").innerHTML='<p>				<button type="button" onclick="exportXLSX(true)">Export Data</button>			</p>			<p>				<object id="file-object"></object>				<button type="button" onclick="addToXLSX()">Add Data to Selected File</button>				<a href="https://chrome.google.com/webstore/detail/downloads-overwrite-exist/fkomnceojfhfkgjgcijfahmgeljomcfk">This Chrome extension is required to update an existing spreadsheet.</a>			</p>			<p>				Schedule for Day:				<select id="sselector" onchange="schedule = document.getElementById("sselector").value;">					<option value="normal">Standard day</option>					<option value="earlyReleaseOrClubDay">Early Release/Club Day</option>					<option value="oneHourDelay">1 Hour Delay</option>					<option value="twoHourDelay">2 Hour Delay</option>				</select>			</p>			<button type="button" onclick="endVisitors(); endCVisits()">Sign Out All Visitors</button>			<button type="button" onclick="closeMenu()">Lock Librarian Menu</button>',document.getElementById("sselector").value=schedule,epx.openLocal({labelButton:"Select Excel File"},function(){}),constructDisplay(hallPass.slice(0),"hdisplay"),constructDisplay(visitors.slice(0),"vdisplay"),constructDisplay(cVisits.slice(0),"cdisplay")):alert("Incorrect password!")}function closeMenu(){document.getElementById("l").innerHTML='<span><input type="password" id="pwbox" placeholder="Password"></span>		<span><button onclick="passWord(\'pwbox\')">Submit</button></span>',constructDisplay(hallPass.slice(0),"hdisplay"),constructDisplay(visitors.slice(0),"vdisplay"),constructDisplay(cVisits.slice(0),"cdisplay")}function hallPassTeachers(){var e=document.getElementById("hdestination").value,t=document.getElementById("moreinputs");switch(e){case"Teacher":t.innerHTML='<input type="text" id="hteacher" placeholder="Teacher">';break;case"Guidance":t.innerHTML='<input type="text" id="hcounselor" placeholder="Guidance Counselor">';break;default:t.innerHTML=""}}function passWordCheck(e){var t=[66,72,83,76,105,98,114,97,114,121];if(t.length!=e.length)return!1;for(i=e.length-1;i>=0;i--)if(t[i]!=e.charCodeAt(i))return!1;return!0}function whichClass(){for(var e=beginTimes(),t=0,n=getTime("minct");n>=e[t];)t++;return t}function beginTimes(){switch(schedule){case"earlyReleaseOrClubDay":return[486,540,546,595,601,685,691,740];case"oneHourDelay":return[546,620,626,700,706,810,816,890];case"twoHourDelay":return[606,665,671,730,736,825,831,890];default:return[486,575,581,670,676,795,801,890]}}var hallPass=[["Name","Time Out","Time In","Destination"]],visitors=[["Name","Time In","Time Out","Reason","Teacher"]],cVisits=[["Name","Time In","Time Out","Reason","Student Count"]],firstClass=[["Name","Time","Tardy?"]],secondClass=[["Name","Time","Tardy?"]],thirdClass=[["Name","Time","Tardy?"]],fourthClass=[["Name","Time","Tardy?"]],schedule="normal",epx=new ExcelPlus,lIOV=!1,lIOC=!1,lIOH=!1;setInterval(function(){exportXLSX(!1)},36e5);
